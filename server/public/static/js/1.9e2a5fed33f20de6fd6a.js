webpackJsonp([1,8],{115:function(t,e,s){e=t.exports=s(3)(),e.push([t.id,"","",{version:3,sources:[],names:[],mappings:"",file:"Protocols.vue",sourceRoot:"webpack://"}])},130:function(t,e,s){e=t.exports=s(3)(),e.push([t.id,"","",{version:3,sources:[],names:[],mappings:"",file:"Main.vue",sourceRoot:"webpack://"}])},131:function(t,e,s){e=t.exports=s(3)(),e.push([t.id,"","",{version:3,sources:[],names:[],mappings:"",file:"ProtocolsForm.vue",sourceRoot:"webpack://"}])},138:function(t,e,s){e=t.exports=s(3)(),e.push([t.id,"","",{version:3,sources:[],names:[],mappings:"",file:"Form.vue",sourceRoot:"webpack://"}])},150:function(t,e,s){var n=s(115);"string"==typeof n&&(n=[[t.id,n,""]]);s(4)(n,{});n.locals&&(t.exports=n.locals)},165:function(t,e,s){var n=s(130);"string"==typeof n&&(n=[[t.id,n,""]]);s(4)(n,{});n.locals&&(t.exports=n.locals)},166:function(t,e,s){var n=s(131);"string"==typeof n&&(n=[[t.id,n,""]]);s(4)(n,{});n.locals&&(t.exports=n.locals)},174:function(t,e,s){var n=s(138);"string"==typeof n&&(n=[[t.id,n,""]]);s(4)(n,{});n.locals&&(t.exports=n.locals)},209:function(t,e,s){var n,a;s(174),n=s(335);var o=s(262);a=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(a=n=n.default),"function"==typeof a&&(a=a.options),a.render=o.render,a.staticRenderFns=o.staticRenderFns,t.exports=n},210:function(t,e,s){var n,a;s(165),n=s(336);var o=s(253);a=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(a=n=n.default),"function"==typeof a&&(a=a.options),a.render=o.render,a.staticRenderFns=o.staticRenderFns,t.exports=n},211:function(t,e,s){var n,a;s(150),n=s(337);var o=s(237);a=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(a=n=n.default),"function"==typeof a&&(a=a.options),a.render=o.render,a.staticRenderFns=o.staticRenderFns,t.exports=n},212:function(t,e,s){var n,a;s(166),n=s(338);var o=s(254);a=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(a=n=n.default),"function"==typeof a&&(a=a.options),a.render=o.render,a.staticRenderFns=o.staticRenderFns,t.exports=n},237:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"main"}},[s("div",{staticClass:"row"},[t._m(0),t._v(" "),s("div",{staticClass:"col-md-6 text-right"},[s("div",{staticClass:"button-within-header"},[s("a",{directives:[{name:"show",rawName:"v-show",value:!t.isFormVisible,expression:"!isFormVisible"}],staticClass:"btn btn-default btn-sm",attrs:{href:"#"},on:{click:t.create}},[s("i",{staticClass:"fa fa-plus"})]),t._v(" "),s("a",{directives:[{name:"show",rawName:"v-show",value:t.isFormVisible,expression:"isFormVisible"}],staticClass:"btn btn-default btn-sm",attrs:{href:"#"},on:{click:t.hide}},[s("i",{staticClass:"fa fa-minus"})])])])]),t._v(" "),s("div",{staticClass:"divider"}),t._v(" "),s("transition",{attrs:{name:"fade"}},[s("router-view")],1),t._v(" "),s("div",{staticClass:"table-content"},[s("table",{staticClass:"table table-striped"},[t._m(1),t._v(" "),s("tbody",t._l(t.protocols,function(e){return s("tr",[s("td",[t._v(t._s(e.procedure))]),t._v(" "),s("td",[t._v(t._s(e.name))]),t._v(" "),s("td",[s("a",{staticClass:"btn btn-default btn-sm",attrs:{href:"#"},on:{click:function(s){t.editProtocol(e)}}},[s("i",{staticClass:"fa fa-edit"})]),t._v(" "),s("a",{staticClass:"btn btn-danger btn-sm",attrs:{href:"#"},on:{click:function(s){t.askRemoveProtocol(e)}}},[s("i",{staticClass:"fa fa-times"})])])])}))])]),t._v(" "),s("pagination",{attrs:{paginationData:t.pagination,currentPage:t.currentPage,maxItems:t.pagination.total}})],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"col-md-6"},[s("h1",[t._v("实验方法管理")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("th",[t._v("所属流程")]),s("th",[t._v("名称")]),s("th",[t._v("操作")])])])}]}},253:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{attrs:{id:"list"}},[s("h3",[t._v("所有技术路线")]),t._v(" "),s("a",{staticClass:"btn btn-primary",attrs:{href:"#"},on:{click:function(e){e.preventDefault(),t.addNew()}}},[s("i",{staticClass:"fa fa-plus"}),t._v("添加新技术路线\n    ")]),t._v(" "),s("span",{staticClass:"dropdown",class:{open:t.addMore}},[s("a",{staticClass:"btn btn-default",attrs:{href:"#"},on:{click:function(e){e.preventDefault(),t.clickAddMore()}}},[t._v("\n        其余功能"),s("i",{staticClass:"fa fa-angle-down"})]),t._v(" "),s("ul",{staticClass:"dropdown-menu"},[s("li",[s("a",{attrs:{href:"#"},on:{click:function(e){e.preventDefault(),t.protocols(e)}}},[t._v("所有实验方法")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#"},on:{click:function(e){e.preventDefault(),t.newManager(e)}}},[t._v("添加项目负责人")])])])]),t._v(" "),s("div",{staticClass:"table-content"},[s("table",{staticClass:"table table-striped"},[t._m(0),t._v(" "),s("tbody",t._l(t.pipelines,function(e){return s("tr",[s("td",[t._v(t._s(e.id))]),t._v(" "),s("td",[t._v(t._s(e.name))]),t._v(" "),s("td",[s("a",{staticClass:"btn btn-default btn-sm",attrs:{href:"#"},on:{click:function(s){t.editPipeline(e)}}},[s("i",{staticClass:"fa fa-edit"})]),t._v(" "),s("a",{staticClass:"btn btn-danger btn-sm",attrs:{href:"#"},on:{click:function(s){t.askRemovePipeline(e)}}},[s("i",{staticClass:"fa fa-times"})])])])}))]),t._v(" "),s("pagination",{attrs:{paginationData:t.pagination,currentPage:t.currentPage,maxItems:t.pagination.total}})],1)]),t._v(" "),s("div",{staticClass:"modal fade",attrs:{id:"managersForm",tabindex:"-1",role:"dialog"}},[s("div",{staticClass:"modal-dialog modal-md"},[s("div",{staticClass:"modal-content"},[s("table",{staticClass:"table"},[t._m(1),t._v(" "),s("tbody",[t._l(t.managers,function(e){return s("tr",[s("td",[t._v(t._s(e.name))]),t._v(" "),s("td",[s("a",{staticClass:"btn btn-sm btn-default",attrs:{href:"#"},on:{click:function(s){t.editManager(e)}}},[s("i",{staticClass:"fa fa-edit"})]),t._v(" "),s("a",{staticClass:"btn btn-sm btn-warning",attrs:{href:"#"},on:{click:function(s){t.deleteManager(e)}}},[s("i",{staticClass:"fa fa-delete"})])])])}),t._v(" "),s("tr",[s("form",{on:{submit:function(e){e.preventDefault(),t.addNewManager()}}},[s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.manager.name,expression:"manager.name"}],staticClass:"form-control",attrs:{type:"text",placeholder:"姓名"},domProps:{value:t._s(t.manager.name)},on:{input:function(e){e.target.composing||(t.manager.name=e.target.value)}}})]),t._v(" "),s("td",[s("button",{staticClass:"btn btn-primary",on:{click:function(e){e.preventDefault(),t.addNewManager(e)}}},[t._v("添加")])])])])],2)])])])]),t._v(" "),s("div",{attrs:{id:"main"}},[s("router-view")],1)])},staticRenderFns:[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("th",[t._v("ID")]),s("th",[t._v("名称")]),s("th",[t._v("操作")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("th",[t._v("姓名")]),s("th",[t._v("操作")])])])}]}},254:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("form",{staticClass:"well"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-sm-6"},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"control-label",attrs:{for:"procedure"}},[t._v("所属流程")]),t._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:t.form.procedure,expression:"form.procedure"}],staticClass:"form-control",attrs:{id:"procedure"},on:{change:function(e){t.form.procedure=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e})[0]}}},t._l(t.procedures,function(e){return s("option",{domProps:{value:e.id}},[t._v(t._s(e.name))])}))])]),t._v(" "),s("div",{staticClass:"col-sm-6"},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"control-label",attrs:{for:"name"}},[t._v("名称")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.name,expression:"form.name"}],staticClass:"form-control",attrs:{id:"name",type:"text"},domProps:{value:t._s(t.form.name)},on:{input:function(e){e.target.composing||(t.form.name=e.target.value)}}})])])]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-sm-12"},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"control-label",attrs:{for:"form.content"}},[t._v("详细步骤")]),t._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.content,expression:"form.content"}],attrs:{rows:"8",cols:"80",id:"form.content"},domProps:{value:t._s(t.form.content)},on:{input:function(e){e.target.composing||(t.form.content=e.target.value)}}})])])]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-sm-4 col-sm-offset-4"},[s("a",{staticClass:"btn btn-primary full-width",attrs:{href:"#"},on:{click:t.submit}},[t._v("保存")])])])])])},staticRenderFns:[]}},262:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-6"},[s("h1",[t._v(t._s(t.formTitle))])])]),t._v(" "),s("div",{staticClass:"divider"}),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-sm-10 col-sm-offset-1"},[s("form",[s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-12"},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"control-label",attrs:{for:"name"}},[t._v("技术路线名称")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.name,expression:"form.name"}],staticClass:"form-control",attrs:{type:"text",id:"name"},domProps:{value:t._s(t.form.name)},on:{input:function(e){e.target.composing||(t.form.name=e.target.value)}}})])])]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-12"},[s("table",{staticClass:"table table-striped"},[t._m(0),t._v(" "),s("tbody",[t._l(t.form.steps,function(e){return s("tr",[s("td",[s("span",{staticClass:"next"},[t._v(t._s(e.step))])]),t._v(" "),s("td",[s("select",{directives:[{name:"model",rawName:"v-model",value:e.procedure,expression:"step.procedure"}],staticClass:"form-control",on:{change:function(t){e.procedure=Array.prototype.filter.call(t.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e})[0]}}},t._l(t.procedures,function(e){return s("option",{domProps:{value:e.id}},[t._v(t._s(e.name))])}))]),t._v(" "),s("td",[s("select",{directives:[{name:"model",rawName:"v-model",value:e.protocol,expression:"step.protocol"}],staticClass:"form-control",on:{change:function(t){e.protocol=Array.prototype.filter.call(t.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e})[0]}}},t._l(t.protocols,function(t){return s("option",{attrs:{label:t.name},domProps:{value:t.id}})}))]),t._v(" "),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.time,expression:"step.time"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t._s(e.time)},on:{input:function(t){t.target.composing||(e.time=t.target.value)}}})]),t._v(" "),s("td",[s("a",{staticClass:"btn btn-danger btn-sm",attrs:{href:"#"},on:{click:function(s){t.removeLine(e)}}},[s("i",{staticClass:"fa fa-times"})])])])}),t._v(" "),s("tr",[s("td",{attrs:{colspan:"3"}},[s("a",{staticClass:"btn btn-info btn-sm",attrs:{href:"#"},on:{click:t.addNewLine}},[s("i",{staticClass:"fa fa-plus"})])])])],2)])])]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-sm-4 col-sm-offset-4"},[s("button",{staticClass:"btn btn-primary btn-block",on:{click:function(e){e.preventDefault(),t.submit()}}},[t._v("保存")])])])])])])])},staticRenderFns:[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("th",[t._v("步骤")]),t._v(" "),s("th",[t._v("实验流程")]),t._v(" "),s("th",[t._v("实验方法")]),t._v(" "),s("th",[t._v("耗时")]),t._v(" "),s("th")])])}]}},335:function(t,e,s){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=s(1),o=n(a),i=s(9),r=n(i),c=s(11),l=s(2);e.default={data:function(){return{form:{id:0,name:"",steps:[{step:1,procedure:0,protocol:0,time:0}]}}},watch:(0,r.default)({$route:"fetch"},"$route","reset"),mounted:function(){this.fetch(),console.log((0,o.default)({},this.procedures))},computed:(0,o.default)({},(0,l.mapState)({procedures:function(t){return t.procedures},protocols:function(t){return t.Pipelines.protocols}}),{isEditing:function(){return this.form.id>0},isValid:function(){return!0},formTitle:function(){return this.form.id>0?"修改技术路线信息":"新增技术路线"}}),methods:(0,o.default)({},(0,l.mapActions)(["proceduresSetData","protocolsSetData","setFetching","resetMessages","setMessage"]),{fetch:function(){var t=this,e=this.$route.params.id;void 0!==e&&(this.setFetching({fetching:!0}),this.$http.get("pipelines/"+e).then(function(e){var s=e.data,n=s.data;t.form=(0,o.default)({},n),t.setFetching({fetching:!1})})),this.$http.get("procedures").then(function(e){var s=e.data;t.proceduresSetData({procedures:s})}),this.$http.get("protocols").then(function(e){var s=e.data;t.protocolsSetData({protocols:s.data})})},addNewLine:function(){this.form.steps.push({step:this.form.steps.length+1,procedure:0,protocol:0,time:0})},removeLine:function(t){var e=this.form.steps.indexOf(t);this.form.steps.splice(e,1)},submit:function(){this.isValid&&(this.setFetching({fetching:!0}),this.isEditing?this.update():this.save())},save:function(){var t=this;this.$http.post("pipelines",(0,c.pick)(this.form,["name","manager"])).then(function(){t.$bus.$emit("pipelines.created"),t.setFetching({fetching:!1}),t.setMessage({type:"success",message:"新技术路线录入成功"}),t.reset()})},update:function(){var t=this;this.$http.put("pipelines/"+this.form.id,this.form).then(function(){t.$bus.$emit("pipelines.updated"),t.setMessage({type:"success",message:"技术路线信息更新成功"}),t.reset()})},reset:function(){this.form.id=0,this.form.name="",this.form.steps=[{step:1,procedure:0,protocol:0,time:0}]}})}},336:function(t,e,s){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a,o=s(9),i=n(o),r=s(1),c=n(r),l=s(2);e.default={data:function(){return{manager:{name:""},addMore:!1}},mounted:function(){var t=this;this.$bus.$on("navigate",function(e){return t.navigate(e)}),this.$bus.$on("pipelines.created",function(){return t.fetchPipelines()}),this.$bus.$on("pipelines.updated",function(){return t.fetchPipelines()}),this.fetchPipelines()},computed:(0,c.default)({},(0,l.mapState)({pipelines:function(t){return t.Pipelines.pipelines},pipelines_pagination:function(t){return t.Pipelines.pipelines_pagination},managers:function(t){return t.Pipelines.managers}}),{currentPage:function(){return parseInt(this.$route.query.page,10)||1},pagination:function(){return this.pipelines_pagination}}),beforeRouterLeave:function(t,e,s){this.$bus.$off("pipelines.created"),this.$bus.$off("pipelines.updated"),s()},watch:{currentPage:"fetchBatches"},methods:(0,c.default)({},(0,l.mapActions)(["pipelinesSetData","managersSetData","locationsSetData"]),(a={fetchPipelines:function(){var t=this;this.$http.get("pipelines?page="+this.currentPage).then(function(e){var s=e.data;t.pipelinesSetData({pipelines:s.data,pipelines_pagination:s.meta.pagination})})},fetchManagers:function(){var t=this;this.$http.get("managers").then(function(e){var s=e.data;t.managersSetData({managers:s.data})})},protocols:function(){this.$router.push({name:"protocols.index"})},clickAddMore:function(){this.addMore=!this.addMore},addNew:function(){this.$router.push({name:"pipelines.new"})}},(0,i.default)(a,"protocols",function(t){var e=t.id;this.$router.push({name:"pipeline.protocols.index",params:{id:e}})}),(0,i.default)(a,"editPipeline",function(t){var e=t.id;this.$router.push({name:"pipelines.edit",params:{id:e}})}),(0,i.default)(a,"askRemovePipeline",function(t){var e=this;swal({title:"确定吗？",text:"技术路线"+t.id+"将会被删除",type:"warning",showCancelButton:!0,confirmButtonColor:"#dd6b55",confirmButtonText:"确定",closeOnConfirm:!1},function(){return e.deletePipeline(t)})}),(0,i.default)(a,"deletePipeline",function(t){this.$http.delete("pipelines/"+t.id).then(function(){swal("完成","技术路线删除成功","success")})}),(0,i.default)(a,"newManager",function(){this.fetchManagers(),this.clickAddMore(),$("#managersForm").modal("show")}),(0,i.default)(a,"addNewManager",function(){}),(0,i.default)(a,"editManager",function(t){}),(0,i.default)(a,"deleteManager",function(t){}),(0,i.default)(a,"navigate",function(t){this.$router.push({name:"batches.index",query:{page:t.page}})}),a))}},337:function(t,e,s){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=s(1),o=n(a),i=s(2);e.default={data:function(){return{addMore:!1}},mounted:function(){var t=this;this.$bus.$on("navigate",function(e){return t.navigate(e)}),this.$bus.$on("protocols.created",function(){return t.fetchProtocols()}),this.$bus.$on("protocols.updated",function(){return t.fetchProtocols()}),this.fetchProtocols()},computed:(0,o.default)({},(0,i.mapState)({protocols:function(t){return t.Pipelines.protocols},protocols_pagination:function(t){return t.Pipelines.protocols_pagination}}),{currentPage:function(){return parseInt(this.$route.query.page,10)||1},pagination:function(){return this.protocols_pagination},isFormVisible:function(){return"protocols.new"===this.$route.name||"protocols.edit"===this.$route.name}}),watch:{currentPage:"fetchProtocols",$route:"fetchProtocols"},beforeRouterLeave:function(t,e,s){this.$bus.$off("protocols.created"),this.$bus.$off("protocols.updated"),s()},methods:(0,o.default)({},(0,i.mapActions)(["protocolsSetData","setFetching","setMessage"]),{fetchProtocols:function(){var t=this;this.setFetching({fetching:!0}),this.$http.get("protocols?page="+this.currentPage).then(function(e){var s=e.data;t.protocolsSetData({protocols:s.data,protocols_pagination:s.meta.pagination}),t.setFetching({fetching:!1})})},clickAddMore:function(){this.addMore=!this.addMore},create:function(){this.$router.push({name:"protocols.new",query:{page:this.currentPage}})},hide:function(){this.$router.push({name:"protocols.index",query:{page:this.currentPage}})},editProtocol:function(t){var e=t.id;this.$router.push({name:"protocols.edit",params:{protocol_id:e}})},askRemoveProtocol:function(t){var e=this;swal({title:"确定吗？",text:"实验方法"+t.name+"将会被删除",type:"warning",showCancelButton:!0,confirmButtonColor:"#dd6b55",confirmButtonText:"确定",closeOnConfirm:!1},function(){return e.deleteProtocol(t)})},deleteProtocol:function(t){var e=this;this.$http.delete("protocols/"+t.id).then(function(){swal("完成","实验方法删除成功","success"),e.fetchProtocols()})},navigate:function(t){this.$router.push({name:"protocols.index",query:{page:t.page}})}})}},338:function(t,e,s){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=s(1),o=n(a),i=s(2);e.default={data:function(){return{form:{id:0,procedure:0,name:"",content:""}}},computed:(0,o.default)({},(0,i.mapState)({procedures:function(t){return t.procedures}}),{isEditing:function(){return this.form.id>0},isValid:function(){return!0},showCreateForm:function(){return"protocols.new"===this.$route.name}}),mounted:function(){this.fetch(),this.fetchProcedures()},watch:{$route:"fetch"},methods:(0,o.default)({},(0,i.mapActions)(["proceduresSetData","setFetching","resetMessages","setMessage"]),{fetch:function(){var t=this,e=this.$route.params.protocol_id;void 0!==e&&(this.setFetching({fetching:!0}),this.$http.get("protocols/"+e).then(function(e){var s=e.data;t.form=(0,o.default)({},s.data),console.log(t.form)}))},fetchProcedures:function(){this.$http.get("procedures").then(function(t){var e=t.data;proceduresSetData({procedures:e})})},submit:function(){this.isValid&&(this.isEditing?this.update():this.save())},update:function(){var t=this;this.$http.put("protocols/"+this.form.id,this.form).then(function(){t.$bus.$emit("protocols.updated"),t.setFetching({fetching:!1}),t.setMessage({type:"success",message:"实验方法更新成功"}),t.reset()})},save:function(){var t=this;this.$http.post("protocols",this.form).then(function(){t.$bus.$emit("protocols.created"),t.setFetching({fetching:!1}),t.setMessage({type:"success",message:"实验方法添加成功"}),t.reset()})},reset:function(){this.form.id=0,this.form.procedure=0,this.form.name="",this.form.content=""}})}}});
//# sourceMappingURL=1.9e2a5fed33f20de6fd6a.js.map